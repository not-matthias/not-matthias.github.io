<!doctype html><html class="dark light" lang=en><head><meta charset=UTF-8><meta content="IE=edge" http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0" name=viewport><meta content=https://not-matthias.github.io name=base><title>
            
                Tracking Anticheat Updates
            
        </title><meta content="Tracking Anticheat Updates" property=og:title><link href=https://not-matthias.github.io/fonts.css rel=stylesheet><link media="(prefers-color-scheme: dark)" href=/syntax-theme-dark.css rel=stylesheet><link media="(prefers-color-scheme: light)" href=/syntax-theme-light.css rel=stylesheet><script data-host-url=https://api-gateway.umami.dev/ data-website-id=74344cd8-1e87-4c38-8acd-f96049b8f07e defer src=/js/imamu.js></script><script async data-goatcounter=https://not-matthias.goatcounter.com/count src=https://not-matthias.github.io/js/count.js></script><noscript><img src="https://not-matthias.goatcounter.com//count?p=/posts/anticheat-update-tracking/&t=Tracking Anticheat Updates"></noscript><link title="
    not-matthias
" href=https://not-matthias.github.io/atom.xml rel=alternate type=application/atom+xml><link title="
    not-matthias
" href=https://not-matthias.github.io/rss.xml rel=alternate type=application/rss+xml><link href=https://not-matthias.github.io/theme/light.css rel=stylesheet><link href=https://not-matthias.github.io/theme/dark.css id=darkModeStyle rel=stylesheet><script src=https://not-matthias.github.io/js/themetoggle.js></script><script>setTheme(getSavedTheme());</script><link href=https://not-matthias.github.io/main.css media=screen rel=stylesheet><body><div class=left-content></div><div class=content><nav><div class=left-nav><a href=https://not-matthias.github.io>not-matthias</a><div class=socials><a rel="'me'" class=social href=https://twitter.com/not_matthias> <img alt=twitter src=https://not-matthias.github.io/icons/social/twitter.svg> </a><a rel="'me'" class=social href=https://github.com/not-matthias/> <img alt=github src=https://not-matthias.github.io/icons/social/github.svg> </a><a rel="'me'" class=social href=/atom.xml> <img alt=rss src=https://not-matthias.github.io/icons/social/rss.svg> </a></div></div><div class=right-nav><a href=https://not-matthias.github.io/posts style=margin-right:.5em>/posts</a><a href=https://not-matthias.github.io/projects style=margin-right:.5em>/projects</a><a href=https://not-matthias.github.io/talks style=margin-right:.5em>/talks</a><a onclick="toggleTheme(); event.preventDefault();" href=# id=dark-mode-toggle> <img alt=Light id=sun-icon src=https://not-matthias.github.io/icons/sun.svg> <img alt=Dark id=moon-icon src=https://not-matthias.github.io/icons/moon.svg style=filter:invert()> <img alt=Auto id=auto-icon src=https://not-matthias.github.io/icons/auto.svg style=filter:invert()> </a><script>updateItemToggleTheme()</script></div></nav><div data-selector="main article p" class=visible-element-observer-root><main><article><div class=title><div class=page-header>Tracking Anticheat Updates</div><div class=meta>Posted on <time>2025-06-26</time> :: <time>8</time> Min Read <span class=tags-label>::</span><span class=tags> <a class=post-tag href=https://not-matthias.github.io/tags/anticheat/>anticheat</a> <a class=post-tag href=https://not-matthias.github.io/tags/security/>security</a> </span></div></div><section class=body><p>A few years ago when I was into reverse engineering and binary analysis (and game modding), I did a lot of research into anticheats work. I was curious about tracking their updates, since that would allow me to:<ul><li>Know when a new version is released<li>Understand what changes were made<li>Use older versions for research purposes</ul><p>So I ended up researching different ways on how to track updates of various anticheats. Some of them are already very well documented, while others haven't been explored much. This post will summarize my findings and outline how they work.<h1 id=easyanticheat>EasyAntiCheat</h1><p>EasyAntiCheat is widely recognized as one of the most advanced anticheats, and is used in many popular games like Rust, Fortnite, Apex Legends, and more.<p>Prior to the acquisition by Epic Games, EAC was using their own CDN to distribute updates: <code>https://download.eac-cdn.com/api/v1/games/{game_id}/client/{system}/download/?uuid=1239688</code>.<ul><li><code>game_id</code>: unique identifier for each game (e.g. 154 for Apex Legends)<li><code>system</code>: target platform/system (e.g. <code>wow64_win64</code>, <code>mac64</code>, <code>linux32_64</code>).</ul><p>After the acquisition, they switched to the EpicGames CDN, which has a slightly different URL structure: <code>https://modules-cdn.eac-prod.on.epicgames.com/modules/{product_id}/{deployment_id}/{system}</code>. The parameters to this URL are completely different:<ul><li><code>product_id</code>: unique identifier for each game (e.g. <code>429c2212ad284866aee071454c2125b5</code> for Rust)<li><code>deployment_id</code>: unique identifier for each deployment (e.g. <code>76796531e86443548754600511f42e9e</code> for Rust). This doesn't change when an update is released and is used to identify different game versions.<li><code>system</code>: same as in the old CDN</ul><p>After downloading the module for a game, we'll have a file which contains data with a very high entropy which is the first indication that it is encrypted or compressed:<pre class=z-code><code><span class="z-text z-plain">$ bat encrypted.bin | ent
</span><span class="z-text z-plain">Entropy = 7.989390 bits per byte.
</span></code></pre><p>Looking at the data, we also can't really identify any patterns or strings. However, across versions the header seems to always stay the same (<code>a7 ed</code>): Very interesting ğŸ¤”<pre class=z-code><code><span class="z-text z-plain">$ hexyl encrypted.bin | head
</span><span class="z-text z-plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span class="z-text z-plain">â”‚00000000â”‚ a7 ed 96 0c 0f 0f 12 19 â”Š 1c 1b 1e 20 22 26 2a e5 â”‚Ã—Ã—Ã—_â€¢â€¢â€¢â€¢â”Šâ€¢â€¢â€¢ "&*Ã—â”‚
</span><span class="z-text z-plain">â”‚00000010â”‚ e8 33 36 39 3c 3f 42 85 â”Š 88 4b 4e 51 54 57 5a 5d â”‚Ã—369&lt;?BÃ—â”ŠÃ—KNQTWZ]â”‚
</span><span class="z-text z-plain">â”‚00000020â”‚ 60 63 66 69 6c 6f 72 75 â”Š 78 7b 7e 81 84 87 8a 8d â”‚`cfiloruâ”Šx{~Ã—Ã—Ã—Ã—Ã—â”‚
</span><span class="z-text z-plain">â”‚00000030â”‚ 90 93 96 99 9c 9f a2 a5 â”Š a8 ab ae 31 34 b7 ba cb â”‚Ã—Ã—Ã—Ã—Ã—Ã—Ã—Ã—â”ŠÃ—Ã—Ã—14Ã—Ã—Ã—â”‚
</span><span class="z-text z-plain">â”‚00000040â”‚ ed 9c 8e d7 80 8c a8 c3 â”Š b1 94 2b fa d2 5c a6 be â”‚Ã—Ã—Ã—Ã—Ã—Ã—Ã—Ã—â”ŠÃ—Ã—+Ã—Ã—\Ã—Ã—â”‚
</span><span class="z-text z-plain">â”‚00000050â”‚ cc 86 86 db dd d5 db d8 â”Š d6 98 91 d5 e3 f3 f7 00 â”‚Ã—Ã—Ã—Ã—Ã—Ã—Ã—Ã—â”ŠÃ—Ã—Ã—Ã—Ã—Ã—Ã—â‹„â”‚
</span><span class="z-text z-plain">â”‚00000060â”‚ b4 a5 ed ae be 16 15 c3 â”Š c1 12 cc a5 d7 e9 bd da â”‚Ã—Ã—Ã—Ã—Ã—â€¢â€¢Ã—â”ŠÃ—â€¢Ã—Ã—Ã—Ã—Ã—Ã—â”‚
</span><span class="z-text z-plain">â”‚00000070â”‚ 2c 26 1f ec 97 79 79 93 â”Š 8c 6b 6e 71 74 77 7a cd â”‚,&â€¢Ã—Ã—yyÃ—â”ŠÃ—knqtwzÃ—â”‚
</span><span class="z-text z-plain">â”‚00000080â”‚ 15 c8 86 d5 d9 93 95 c9 â”Š 4d 6e 58 09 a4 a7 aa ad â”‚â€¢Ã—Ã—Ã—Ã—Ã—Ã—Ã—â”ŠMnX_Ã—Ã—Ã—Ã—â”‚
</span></code></pre><p>A few years ago, I spent a <del>night</del> early morning with a friend to find the decryption algorithm. We searched for anything that closely resembled such an algorithm, eventually found it, made a quick POC and got it working ğŸ”¥. Here's what the code looks like:<pre class="language-cpp z-code" data-lang=cpp><code class=language-cpp data-lang=cpp><span class="z-source z-c++"><span class="z-storage z-type z-c">void</span> <span class="z-meta z-function z-c++"><span class="z-meta z-toc-list z-full-identifier z-c++"><span class="z-entity z-name z-function z-c++">decode</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span></span></span><span class="z-meta z-function z-parameters z-c++"><span class="z-meta z-group z-c++"><span class="z-storage z-type z-c">char</span> <span class="z-keyword z-operator z-c">*</span><span class="z-variable z-parameter z-c++">memory_block</span><span class="z-punctuation z-separator z-c++">,</span> <span class="z-storage z-type z-c">int</span> <span class="z-variable z-parameter z-c++">total_size</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span></span><span class="z-meta z-function z-c++"> </span><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span></span></span><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">
</span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span> buffer <span class="z-keyword z-operator z-assignment z-c">=</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span><span class="z-storage z-type z-c">char</span><span class="z-keyword z-operator z-c">*</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span>memory_block<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-storage z-type z-c">int</span> file_size <span class="z-keyword z-operator z-assignment z-c">=</span> total_size<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++">    <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>file_size <span class="z-keyword z-operator z-comparison z-c">>=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">2</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">        buffer<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>file_size <span class="z-keyword z-operator z-arithmetic z-c">-</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">3</span> <span class="z-keyword z-operator z-arithmetic z-c">-</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">3</span> <span class="z-keyword z-operator z-c">*</span> file_size<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">        <span class="z-storage z-type z-c">int</span> current_index <span class="z-keyword z-operator z-assignment z-c">=</span> file_size <span class="z-keyword z-operator z-arithmetic z-c">-</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">2</span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">        <span class="z-keyword z-control z-c++">if</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>file_size <span class="z-keyword z-operator z-comparison z-c">!=</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">2</span><span class="z-punctuation z-section z-group z-end z-c++">)</span></span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-keyword z-control z-c++">do</span> <span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-begin z-c++">{</span>
</span></span></span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                buffer<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>current_index<span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">+=</span> <span class="z-keyword z-operator z-arithmetic z-c">-</span><span class="z-constant z-numeric z-integer z-decimal z-c++">3</span> <span class="z-keyword z-operator z-c">*</span> current_index <span class="z-keyword z-operator z-arithmetic z-c">-</span> buffer<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span>current_index <span class="z-keyword z-operator z-arithmetic z-c">+</span> <span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">                <span class="z-keyword z-operator z-arithmetic z-c">--</span>current_index<span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">            <span class="z-punctuation z-section z-block z-end z-c++">}</span></span> <span class="z-keyword z-control z-c++">while</span> <span class="z-meta z-group z-c++"><span class="z-punctuation z-section z-group z-begin z-c++">(</span>current_index<span class="z-punctuation z-section z-group z-end z-c++">)</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">        <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">        buffer<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span><span class="z-constant z-numeric z-integer z-decimal z-c++">0</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span> <span class="z-keyword z-operator z-assignment z-augmented z-c">-=</span> buffer<span class="z-meta z-brackets z-c++"><span class="z-punctuation z-section z-brackets z-begin z-c++">[</span><span class="z-constant z-numeric z-integer z-decimal z-c++">1</span><span class="z-punctuation z-section z-brackets z-end z-c++">]</span></span><span class="z-punctuation z-terminator z-c++">;</span>
</span></span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-meta z-block z-c++">    <span class="z-punctuation z-section z-block z-end z-c++">}</span></span>
</span></span></span><span class="z-source z-c++"><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"></span></span><span class="z-meta z-function z-c++"><span class="z-meta z-block z-c++"><span class="z-punctuation z-section z-block z-end z-c++">}</span></span></span>
</span></code></pre><p>After decrypting the binary blob, we'll finally have a PE image (<code>EasyAnticheat.packed.dll</code>):<pre class=z-code><code><span class="z-text z-plain">$ hexyl EasyAnticheat.packed.dll | head
</span><span class="z-text z-plain">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span class="z-text z-plain">â”‚00000000â”‚ 4d 5a 90 00 03 00 00 00 â”Š 04 00 00 00 ff ff 00 00 â”‚MZÃ—.â€¢...â”Šâ€¢...Ã—Ã—..â”‚
</span><span class="z-text z-plain">â”‚00000010â”‚ b8 00 00 00 00 00 00 00 â”Š 40 00 00 00 00 00 00 00 â”‚Ã—.......â”Š@.......â”‚
</span><span class="z-text z-plain">â”‚00000020â”‚ 00 00 00 00 00 00 00 00 â”Š 00 00 00 00 00 00 00 00 â”‚........â”Š........â”‚
</span><span class="z-text z-plain">â”‚00000030â”‚ 00 00 00 00 00 00 00 00 â”Š 00 00 00 00 80 00 00 00 â”‚........â”Š....Ã—...â”‚
</span><span class="z-text z-plain">â”‚00000040â”‚ 0e 1f ba 0e 00 b4 09 cd â”Š 21 b8 01 4c cd 21 54 68 â”‚â€¢â€¢Ã—â€¢.Ã—_Ã—â”Š!Ã—â€¢LÃ—!Thâ”‚
</span><span class="z-text z-plain">â”‚00000050â”‚ 69 73 20 70 72 6f 67 72 â”Š 61 6d 20 63 61 6e 6e 6f â”‚is progrâ”Šam cannoâ”‚
</span><span class="z-text z-plain">â”‚00000060â”‚ 74 20 62 65 20 72 75 6e â”Š 20 69 6e 20 44 4f 53 20 â”‚t be runâ”Š in DOS â”‚
</span><span class="z-text z-plain">â”‚00000070â”‚ 6d 6f 64 65 2e 0d 0d 0a â”Š 24 00 00 00 00 00 00 00 â”‚mode.___â”Š$.......â”‚
</span><span class="z-text z-plain">â”‚00000080â”‚ 50 45 00 00 4c 01 03 00 â”Š 34 81 52 68 00 00 00 00 â”‚PE..Lâ€¢â€¢.â”Š4Ã—Rh....â”‚
</span></code></pre><p>Unfortunately, we're not yet done. According to <a href=https://github.com/horsicq/Detect-It-Easy>Detect it Easy</a>, the binary is protected with VMProtect, which means we can't just read the <code>.text</code> or <code>.data</code> section. However, to further analyze the binary and extract the driver and usermode module we'll have to find a way to unpack it.</p><img alt="Detect it Easy screenshot" aspect-ratio="1133 / 1133" decoding=async loading=lazy src=https://not-matthias.github.io/processed_images/eac_die.ff04bbcd1ef53ca5.webp><p>There are many ways to unpack binaries, with the most popular being <strong>emulation</strong> and <strong>native execution</strong>. Both methods just execute the entrypoint until the sections are unpacked. In our case, the easiest way to unpack the downloaded binary is to load it with <code>LoadLibraryA</code>:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">windows<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust">core<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">PCSTR</span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust">    <span class="z-meta z-path z-rust">Win32<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span><span class="z-meta z-path z-rust">Foundation<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-constant z-other z-rust">HINSTANCE</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-meta z-path z-rust">System<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">LibraryLoader<span class="z-punctuation z-accessor z-rust">::</span></span>LoadLibraryA</span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-separator z-rust">,</span>
</span></span><span class="z-source z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">pelite<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">pe32<span class="z-punctuation z-accessor z-rust">::</span></span>PeView<span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-keyword z-other z-rust">use</span> <span class="z-meta z-path z-rust">std<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">path<span class="z-punctuation z-accessor z-rust">::</span></span>PathBuf<span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-function z-rust"><span class="z-storage z-type z-function z-rust">fn</span> </span><span class="z-entity z-name z-function z-rust">main</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-begin z-rust">(</span></span><span class="z-meta z-function z-rust"><span class="z-meta z-function z-parameters z-rust"><span class="z-punctuation z-section z-parameters z-end z-rust">)</span></span></span></span><span class="z-meta z-function z-rust"> </span><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-storage z-type z-rust">let</span> file <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-constant z-other z-rust">PCSTR</span><span class="z-meta z-path z-rust"><span class="z-punctuation z-accessor z-rust">::</span></span>from_raw<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>temp.dll<span class="z-constant z-character z-escape z-rust">\0</span><span class="z-punctuation z-definition z-string z-end z-rust">"</span></span><span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">as_ptr</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-rust">as</span> <span class="z-keyword z-operator z-rust">_</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-storage z-type z-rust">let</span> <span class="z-support z-type z-rust">Ok</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>module</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-storage z-modifier z-rust">unsafe</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> LoadLibraryA<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>file</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span> <span class="z-keyword z-control z-rust">else</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    <span class="z-support z-macro z-rust">eprintln!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Failed to load library: <span class="z-constant z-other z-placeholder z-rust">{}</span><span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-separator z-rust">,</span> error<span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">    <span class="z-keyword z-control z-rust">return</span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"><span class="z-meta z-block z-rust">  </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-support z-macro z-rust">println!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span><span class="z-meta z-group z-rust"><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>Loaded module: {:x?}<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-separator z-rust">,</span> module<span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-storage z-type z-rust">let</span> pe <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-storage z-modifier z-rust">unsafe</span> <span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span> <span class="z-meta z-path z-rust">pelite<span class="z-punctuation z-accessor z-rust">::</span></span><span class="z-meta z-path z-rust">PeView<span class="z-punctuation z-accessor z-rust">::</span></span>module<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>module<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span> <span class="z-keyword z-operator z-rust">as</span> <span class="z-storage z-type z-rust">*const</span> <span class="z-storage z-type z-rust">u8</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> </span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust">  <span class="z-comment z-block z-rust"><span class="z-punctuation z-definition z-comment z-rust">/*</span> Analyze the unpacked module <span class="z-punctuation z-definition z-comment z-rust">*/</span></span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-function z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>After analyzing this unpacked library, you'll eventually figure out that the <code>.data</code> section has a high entropy and is quite large. You might even recognize the encrypted PE headers from earlier: <code>a7 ed</code>. This is exactly where the driver and their internal module are stored.<p>The embedded files use the same encryption algorithm, so we can search for the encrypted PE header (<code>MZ</code> or <code>0x4D5A</code>). After looking at the data in IDA, I managed to find a pattern which we can use to extract the embedded files. The encrypted modules are always stored in the following order:<pre class=z-code><code><span class="z-text z-plain">&lt;encrypted_module>  (encrypted data)
</span><span class="z-text z-plain">&lt;size>              (padded to 16 bytes)
</span></code></pre><p>This is somewhat equivalent to the following structure, where len always contains the size of the buffer:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">EncryptedModule</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">buffer</span><span class="z-punctuation z-separator z-type z-rust">:</span> [<span class="z-storage z-type z-rust">u8</span>],
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">len</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-storage z-type z-rust">u64</span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-variable z-other z-member z-rust">padding</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-storage z-type z-rust">u64</span>    <span class="z-comment z-line z-double-slash z-rust"><span class="z-punctuation z-definition z-comment z-rust">//</span> always 0
</span></span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>By knowing that the encrypted module has a high entropy, which means that it's very unlikely that there will be patterns in the data, we can simply search for at least 8 bytes of zero padding which is always present after the size.<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> section <span class="z-keyword z-operator z-assignment z-rust">=</span> pe<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">section_by_name</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-string z-quoted z-double z-rust"><span class="z-punctuation z-definition z-string z-begin z-rust">"</span>.data<span class="z-punctuation z-definition z-string z-end z-rust">"</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>driver_start<span class="z-punctuation z-separator z-rust">,</span> driver_end</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> section<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">find_padding_at</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span><span class="z-constant z-numeric z-integer z-decimal z-rust">0</span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> encrypted_driver <span class="z-keyword z-operator z-assignment z-rust">=</span> section<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>driver_start<span class="z-keyword z-operator z-range z-rust">..</span>driver_end<span class="z-punctuation z-section z-group z-end z-rust">]</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> driver_module <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-function z-rust">decrypt</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>encrypted_driver</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert_eq!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>driver_module<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-keyword z-operator z-range z-rust">..</span><span class="z-constant z-numeric z-integer z-decimal z-rust">2</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-keyword z-operator z-bitwise z-rust">&</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-constant z-numeric z-integer z-hexadecimal z-rust">0x4D</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-hexadecimal z-rust">0x5A</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> <span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>internal_start<span class="z-punctuation z-separator z-rust">,</span> internal_end</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span> <span class="z-keyword z-operator z-assignment z-rust">=</span> section<span class="z-punctuation z-accessor z-dot z-rust">.</span><span class="z-support z-function z-rust">find_padding_at</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>driver_end</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> encrypted_internal <span class="z-keyword z-operator z-assignment z-rust">=</span> section<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span>internal_start<span class="z-keyword z-operator z-range z-rust">..</span>internal_end<span class="z-punctuation z-section z-group z-end z-rust">]</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-storage z-type z-rust">let</span> internal_module <span class="z-keyword z-operator z-assignment z-rust">=</span> <span class="z-support z-function z-rust">decrypt</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>encrypted_internal</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span><span class="z-source z-rust"><span class="z-support z-macro z-rust">assert_eq!</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span>internal_module<span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-keyword z-operator z-range z-rust">..</span><span class="z-constant z-numeric z-integer z-decimal z-rust">2</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-keyword z-operator z-bitwise z-rust">&</span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-constant z-numeric z-integer z-hexadecimal z-rust">0x4D</span><span class="z-punctuation z-separator z-rust">,</span> <span class="z-constant z-numeric z-integer z-hexadecimal z-rust">0x5A</span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span></span><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span><span class="z-punctuation z-terminator z-rust">;</span>
</span></code></pre><h1 id=battleye>Battleye</h1><p>Battleye, another popular anticheat from Germany, is known for its bandaid fixes and <a href=https://www.unknowncheats.me/forum/anti-cheat-bypass/667333-bannleeye-banning-arbitrary-players-using.html>lack of security</a>. They put a lot of focus on detecting popular cheat providers, by detecting them via static signatures. It is used in games like Arma, DayZ, Escape from Tarkov, and most recently Grand Theft Auto V.<p>Their CDN seems to be built in-house and follows a very simple structure:<ol><li>Fetch the latest version (which is just a unix timestamp like <code>1746714230</code>)<li>Download the module using the version number from the actual CDN</ol><p>Here are the required URLs:<ul><li>Version URL: <code>https://cdn.battleye.com/{game}/ver</code><li>Download URL: <code>https://cdn.battleye.com/{game}/{version}</code><li>Possible values for the games include: <code>eft</code>, <code>unturned</code>, <code>ark</code>, <code>r6s/win-x64</code>, <code>dayz/win-x64</code>.</ul><p>The downloaded binary contains other bytes before the actual module, which have to be filtered out. The easiest way to do it is to search for the PE header and delete everything before. In this case, the PE module is located at offset 0x200:<pre class=z-code><code><span class="z-text z-plain">$ binwalk 1732793154
</span><span class="z-text z-plain">---------------------------------------------------------------------------------
</span><span class="z-text z-plain">DECIMAL        HEXADECIMAL         DESCRIPTION
</span><span class="z-text z-plain">---------------------------------------------------------------------------------
</span><span class="z-text z-plain">512            0x200               Windows PE binary, machine type: Intel x86-64
</span><span class="z-text z-plain">---------------------------------------------------------------------------------
</span></code></pre><p>The downloaded file is <code>BEService.exe</code>, which also embeds their kernel driver which is extracted when the service is started. You can use the same techniques as with EAC to extract it, so I won't go into further details.</p><small> While writing this blog post, I realized that some old download URLs of mine still worked. So it seems like the CDN is keeping not only the latest but also previous builds. Since the epoch timestamp only counts the seconds since 1970, it should only take a few days to enumerate all possible IDs. I've thrown together a quick POC, and unfortunately it seems like they are deleted old version :( </small><h1 id=electronic-arts-anti-cheat-ea-ac>Electronic Arts Anti-Cheat (EA-AC)</h1><p><a href=https://www.ea.com/security/news/eaac-deep-dive>EA-AC</a> (not to confuse with EAC) is a relatively new anticheat that was launched in 2022. It is used in games like FIFA or Battlefield, which all use the same installer. The direct download link to their installer can be found on the <a href=https://help.ea.com/en/help/pc/ea-anticheat/#install>help.ea.com</a> page which links to the following URL: <code>https://cdn.eaanticheat.ac.ea.com/EAAntiCheat.Installer.exe</code>.<p>Instead of having to run the installer, we can simply usage <code>7z</code> to extract the contents. However, they are not shipping the driver with the installer anymore, so you need to dump it while running the game or reverse engineer the download.<pre class=z-code><code><span class="z-text z-plain">$ 7z l  EAAntiCheat.Installer.exe
</span><span class="z-text z-plain">   Date      Time    Attr         Size   Compressed  Name
</span><span class="z-text z-plain">------------------- ----- ------------ ------------  ------------------------
</span><span class="z-text z-plain">2025-06-14 08:03:50 .....     44388600     26865015  ProgramFiles/EAAntiCheat.GameService.dll
</span><span class="z-text z-plain">2025-06-14 08:03:36 .....    116300024    108845059  ProgramFiles/EAAntiCheat.GameService.exe
</span><span class="z-text z-plain">2025-06-14 08:04:12 .....        26872        14232  ProgramFiles/preloader_s.dll
</span><span class="z-text z-plain">2025-06-14 08:03:50 .....     37148408     20349480  Title/EAAntiCheat.GameServiceLauncher.dll
</span><span class="z-text z-plain">2025-06-14 08:03:50 .....     15922936     13955947  Title/EAAntiCheat.GameServiceLauncher.exe
</span><span class="z-text z-plain">2025-06-14 08:04:12 .....        27384        14245  Title/preloader_l.dll
</span><span class="z-text z-plain">------------------- ----- ------------ ------------  ------------------------
</span><span class="z-text z-plain">2025-06-14 08:04:12          213814224    170043978  6 files
</span></code></pre><h1 id=vanguard>Vanguard</h1><p><a href=https://en.wikipedia.org/wiki/Riot_Vanguard>Vanguard</a> is the anticheat used in Valorant and League of Legends, developed by Riot Games.<p>Despite their advanced security features, is is relatively easy to track the updates. They provide a public API to fetch the latest config which includes the version and URL for the anticheats modules: <code>https://clientconfig.rpg.riotgames.com/api/v1/config/public</code><pre class=z-code><code><span class="z-text z-plain">{
</span><span class="z-text z-plain">  "anticheat.vanguard.backgroundInstall": false,
</span><span class="z-text z-plain">  "anticheat.vanguard.enabled": true,
</span><span class="z-text z-plain">  "anticheat.vanguard.enforceExactVersionMatching": false,
</span><span class="z-text z-plain">  "anticheat.vanguard.steppingStones": [
</span><span class="z-text z-plain">    "1.16.15.9"
</span><span class="z-text z-plain">  ],
</span><span class="z-text z-plain">  "anticheat.vanguard.url": "https://riot-client.secure.dyn.riotcdn.net/channels/public/rccontent/vanguard/{version}/setup.exe",
</span><span class="z-text z-plain">  "anticheat.vanguard.version": "1.17.6.2",
</span><span class="z-text z-plain">  ...
</span><span class="z-text z-plain">}
</span></code></pre><p>After downloading the files from the CDN and extracting them (again either via <code>7z</code> or by running the installer), we'll have the following files. This already includes the driver and usermode components, so we don't even have to extract anything.<pre class=z-code><code><span class="z-text z-plain">$ 7z l setup.exe
</span><span class="z-text z-plain">Date      Time    Attr         Size   Compressed  Name
</span><span class="z-text z-plain">------------------- ----- ------------ ------------  ------------------------
</span><span class="z-text z-plain">2025-05-05 20:43:53 ....A        21651         6298  vgc.ico
</span><span class="z-text z-plain">2025-05-05 20:54:45 ....A      4494048     55866276  installer.exe
</span><span class="z-text z-plain">2025-05-05 20:57:34 ....A      4285400               log-uploader.exe
</span><span class="z-text z-plain">2025-05-05 20:55:20 ....A     40075376               vgc.exe
</span><span class="z-text z-plain">2025-05-05 14:18:24 .....     26955888               vgk.sys
</span><span class="z-text z-plain">2025-05-05 20:55:53 ....A     10524776               vgm.exe
</span><span class="z-text z-plain">2025-05-05 20:56:48 ....A      3239456               vgrl.dll
</span><span class="z-text z-plain">2025-05-05 20:57:10 ....A      4143376               vgtray.exe
</span><span class="z-text z-plain">------------------- ----- ------------ ------------  ------------------------
</span><span class="z-text z-plain">2025-05-05 20:57:34           93739971     55872574  8 files
</span></code></pre><h1 id=conclusion>Conclusion</h1><p>It's surprising to see the differences in CDNs for different anticheats. You might think, why don't all anticheats have a <em>state-of-the-art military-grade quantum-proof AI encrypted CDNâ„¢</em>: Turns out it doesn't matter if people can extract all of the anticheat modules or figure out when the anticheat updates.<p>At best, it makes it a little bit more inconvenient or time consuming for researchers (which is pretty much the whole purpose of an anticheat). The main purpose is to protect the games and this is done by protecting the modules that do the detections rather than the CDN.<hr><p>I worked on this project a few years ago, even gave a talk at a local meetup about the architecture, but never got around to publish a blog post about the internals. I really enjoyed working on this project, trying out new tech stack and learning about devops, deployment, object storage (MinIO) and a lot more. While some of the information likely is not unknown anymore, I still hope you learned something.<h1 id=appendix>Appendix</h1><h2 id=equ8>EQU8</h2><p><strong>EDIT: Turns out the CDN doesn't work anymore, but I wanted to include it for the sake of completeness</strong><p>EQU8 is an anticheat developed primarily for the game Splitgate. It isn't as advanced as the previously mentioned anticheats, but still provides <em>some</em> level of protection against cheaters.<p>The download URL is as follows: <code>https://download2.equ8.com/v1/a1/{id}/updates.json</code>, where <code>{id}</code> is a unique identifier for the game (e.g. 36 for Splitgate)<p>This response can be parsed with the following structures:<pre class="language-rust z-code" data-lang=rust><code class=language-rust data-lang=rust><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">allow</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">unused</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Debug<span class="z-punctuation z-separator z-rust">,</span> Deserialize</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">Component</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">pub</span> <span class="z-variable z-other z-member z-rust">name</span><span class="z-punctuation z-separator z-type z-rust">:</span> String,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">pub</span> <span class="z-variable z-other z-member z-rust">server_path</span><span class="z-punctuation z-separator z-type z-rust">:</span> String,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">pub</span> <span class="z-variable z-other z-member z-rust">install_path</span><span class="z-punctuation z-separator z-type z-rust">:</span> String,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">pub</span> <span class="z-variable z-other z-member z-rust">rule</span><span class="z-punctuation z-separator z-type z-rust">:</span> String,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">pub</span> <span class="z-variable z-other z-member z-rust">size</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-storage z-type z-rust">i64</span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">pub</span> <span class="z-variable z-other z-member z-rust">hash</span><span class="z-punctuation z-separator z-type z-rust">:</span> String,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Debug<span class="z-punctuation z-separator z-rust">,</span> Deserialize</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">UpdateComponents</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">pub</span> <span class="z-variable z-other z-member z-rust">components</span><span class="z-punctuation z-separator z-type z-rust">:</span> <span class="z-meta z-generic z-rust"><span class="z-support z-type z-rust">Vec</span><span class="z-punctuation z-definition z-generic z-begin z-rust">&lt;</span>Component<span class="z-punctuation z-definition z-generic z-end z-rust">></span></span>,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span><span class="z-source z-rust">
</span><span class="z-source z-rust"><span class="z-meta z-annotation z-rust"><span class="z-punctuation z-definition z-annotation z-rust">#</span><span class="z-punctuation z-section z-group z-begin z-rust">[</span><span class="z-variable z-annotation z-rust">derive</span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-begin z-rust">(</span></span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust">Debug<span class="z-punctuation z-separator z-rust">,</span> Deserialize</span></span><span class="z-meta z-annotation z-parameters z-rust"><span class="z-meta z-group z-rust"><span class="z-punctuation z-section z-group z-end z-rust">)</span></span></span><span class="z-punctuation z-section z-group z-end z-rust">]</span></span>
</span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-storage z-type z-struct z-rust">struct</span> </span><span class="z-meta z-struct z-rust"><span class="z-entity z-name z-struct z-rust">GameUpdate</span> </span><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-begin z-rust">{</span>
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust">    <span class="z-storage z-modifier z-rust">pub</span> <span class="z-variable z-other z-member z-rust">update</span><span class="z-punctuation z-separator z-type z-rust">:</span> UpdateComponents,
</span></span></span><span class="z-source z-rust"><span class="z-meta z-struct z-rust"><span class="z-meta z-block z-rust"></span><span class="z-meta z-block z-rust"><span class="z-punctuation z-section z-block z-end z-rust">}</span></span></span>
</span></code></pre><p>We can then search for the <code>anticheat.x64.equ8.exe</code> file which is the main executable and download it.<h2 id=faceit>FACEIT</h2><p>FACEIT is the anticheat of private leagues for games such as CSGO or League of Legends. They are one of the top anticheats in this space due to their invasive checks and little public information about their detections.<p>You can find the download link on their <a href=https://www.faceit.com/en/anti-cheat>anticheat page</a> which links to here: https://anticheat-client.faceit-cdn.net/FACEITInstaller_64.exe It only includes the frontend iirc, and I didn't spend much more time on it.<h2 id=esea>ESEA</h2><p>This anticheat requires you to have an account, and last time I checked their download page had a CAPTCHA, making it a little bit more inconvenient to track updates. Anyways, here's the download link: https://play.esea.net/index.php?s=downloads&d=download&id=1</section></article></main></div></div><div class=right-content></div>